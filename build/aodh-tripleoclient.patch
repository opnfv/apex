From de3bb2ff31fb19238b164dcc794f6df80f0d0d38 Mon Sep 17 00:00:00 2001
From: Tim Rozet <trozet@redhat.com>
Date: Mon, 25 Jan 2016 19:15:38 +0000
Subject: [PATCH] Adds aodh keystone

---
 constants.py           | 1 +
 utils.py               | 2 ++
 v1/overcloud_deploy.py | 1 +
 3 files changed, 4 insertions(+)

diff --git a/constants.py b/constants.py
index 5b0218f..3816622 100644
--- a/constants.py
+++ b/constants.py
@@ -29,6 +29,7 @@ SERVICE_LIST = {
         'port': '80',
         'path': WEBROOT,
         'admin_path': '%sadmin' % WEBROOT},
+    'aodh': {'password_field': 'OVERCLOUD_AODH_PASSWORD'},
 }
 
 TRIPLEO_HEAT_TEMPLATES = "/usr/share/openstack-tripleo-heat-templates/"
diff --git a/utils.py b/utils.py
index 35591f2..a8eae54 100644
--- a/utils.py
+++ b/utils.py
@@ -60,6 +60,8 @@ def generate_overcloud_passwords(output_file="tripleo-overcloud-passwords"):
         "OVERCLOUD_NOVA_PASSWORD",
         "OVERCLOUD_SWIFT_HASH",
         "OVERCLOUD_SWIFT_PASSWORD",
+        "OVERCLOUD_AODH_PASSWORD",
+        "OVERCLOUD_AODH_SECRET",
     )
 
     passwords = dict((p, passutils.generate_password(size=_MIN_PASSWORD_SIZE))
diff --git a/v1/overcloud_deploy.py b/v1/overcloud_deploy.py
index f4c4892..1a356c4 100644
--- a/v1/overcloud_deploy.py
+++ b/v1/overcloud_deploy.py
@@ -79,6 +79,7 @@ class DeployOvercloud(command.Command):
         parameters['SwiftPassword'] = passwords['OVERCLOUD_SWIFT_PASSWORD']
         parameters['SnmpdReadonlyUserPassword'] = (
             undercloud_ceilometer_snmpd_password)
+        parameters['AodhPassword'] = passwords['OVERCLOUD_AODH_PASSWORD']
 
     def _update_paramaters(self, args, network_client, stack):
         parameters = constants.PARAMETERS.copy()
-- 
1.8.3.1

